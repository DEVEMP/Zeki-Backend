{% extends "base.html" %}

{% block contenido %}
	<div class="container-fluid">
		<!-- .row -->
		<div class="row bg-title" style="background:url(/admin/plugins/images/heading-title-bg.jpg) no-repeat center center /cover;">
			<div class="col-lg-12">
				<h4 class="page-title">Agregar Medicos</h4>
			</div>
		   
			<div class="col-sm-12 col-md-12 col-xs-12">
				<ol class="breadcrumb pull-left">
					<li><a href="/admin">Inicio</a></li>
					<li><a href="/admin/web/medicos">Medicos</a></li>
					<li class="active">Agregar</li>
				</ol>
			</div>
		</div>
		<!-- /.row -->
		
		{% if mensaje_error != '' %}
			<div class="row">
				<div class="col-lg-12 col-sm-12">
					<div class="panel panel-danger">
						<div class="panel-heading">Error !!
							<div class="pull-right">
								<a href="#" data-perform="panel-collapse">
									<i class="ti-minus"></i></a> <a href="#" data-perform="panel-dismiss"><i class="ti-close"></i>
								</a> 
							</div>
						</div>
						<div class="panel-wrapper collapse in" aria-expanded="true">
						<div class="panel-body">
							<p>{{ mensaje_error }}</p>
							
							{% set form_validation = active_form_begin() %}
								<div>{{ form_validation.errorSummary(modelo) | raw }}</div>
							{{ active_form_end() }}
						</div>
					</div>
				</div>
			</div>
		{% endif %}
		
		{% if mensaje_exito != '' %}
			<div class="row">
				<div class="col-lg-12 col-sm-12">
					<div class="panel panel-success">
						<div class="panel-heading">Exito !!
							<div class="pull-right">
								<a href="#" data-perform="panel-collapse">
									<i class="ti-minus"></i></a> <a href="#" data-perform="panel-dismiss"><i class="ti-close"></i>
								</a> 
							</div>
						</div>
						<div class="panel-wrapper collapse in" aria-expanded="true">
						<div class="panel-body">
							<p>{{ mensaje_exito }}</p>
						</div>
					</div>
				</div>
			</div>
		{% endif %}
		
		<div id="notificacion_campos" class="alert alert-danger alert-bold-border fade in alert-dismissable" style="display:none">
			<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
			<strong>Hay un Error!</strong> Debe llenar todos los campos para agregar un nuevo medico a la BD.
		</div>
		
		
		<div class="row">
			<div class="col-sm-12">
				<div class="white-box">
					<h3 class="box-title m-b-0">Agregar Medico</h3>
					<p class="text-muted m-b-20">Formulario para agregar un nuevo medico al sistema</p>
				
					{% set form = active_form_begin({
						'id': 'form_agregar_modelo',
						'options': {
							'class': '',
						}
					}) %}					
						
						<div class="row">
							<div class="col-md-12">
						
								<div class="row">
									<div class="col-md-6" style="display:none">
										<div class="form-group">
											{{  form.field(modelo, 'codigo').textInput({'class': 'form-control', 'data-requerido': '1'}) | raw }}
										</div>
									</div>
									
								</div>
								
								<div class="row">
									<div class="col-md-4">
										<div class="form-group">
											{{  form.field(modelo, 'nombre').textInput({'class': 'form-control', 'data-requerido': '1'}) | raw }}
										</div>
									</div>
									
									<div class="col-md-4">
										<div class="form-group">
											{{  form.field(modelo, 'apellido').textInput({'class': 'form-control', 'data-requerido': '1'}) | raw }}
										</div>	
									</div>
									
									<div class="col-md-4">
										<div class="form-group">
											{{  form.field(modelo, 'email').textInput({'class': 'form-control', 'data-requerido': '1'}) | raw }}
										</div>	
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4">
										<div class="form-group">
											{{  form.field(modelo, 'usuario').textInput({'class': 'form-control', 'data-requerido': '1'}) | raw }}
										</div>	
										
										
										<div class="form-group" style="display:none">
											{{  form.field(modelo, 'especialidad').dropDownList({
											'': 'Seleccione una Opcion', 
											'Medicina General': 'Medicina General',
											'Alergología': 'Alergología',
											'Anestesiología y reanimación': 'Anestesiología y reanimación',
											'Cardiología': 'Cardiología',
											'Gastroenterología': 'Gastroenterología',
											'Endocrinología': 'Endocrinología',
											'Geriatría': 'Geriatría',
											'Hematología y hemoterapia': 'Hematología y hemoterapia',
											'Infectología': 'Infectología',
											'Medicina aeroespacial': 'Medicina aeroespacial',
											'Medicina del deporte': 'Medicina del deporte',
											'Medicina del trabajo': 'Medicina del trabajo',
											'Medicina de urgencias': 'Medicina de urgencias',
											'Medicina familiar y comunitaria': 'Medicina familiar y comunitaria',
											'Medicina física y rehabilitación': 'Medicina física y rehabilitación',
											'Medicina intensiva': 'Medicina intensiva',
											'Medicina interna': 'Medicina interna',
											'Medicina legal y forense': 'Medicina legal y forense',
											'Medicina preventiva y salud pública': 'Medicina preventiva y salud pública',
											'Medicina veterinaria': 'Medicina veterinaria',
											'Nefrología': 'Nefrología',
											'Neumología': 'Neumología',
											'Neurología': 'Neurología',
											'Nutriología': 'Nutriología',
											'Oftalmología': 'Oftalmología',
											'Oncología médica': 'Oncología médica',
											'Oncología radioterápica': 'Oncología radioterápica',
											'Pediatría': 'Pediatría',
											'Psiquiatría': 'Psiquiatría',
											'Rehabilitación': 'Rehabilitación',
											'Reumatología': 'Reumatología',
											'Toxicología': 'Toxicología',
											'Urología': 'Urología',
											}, {'class': 'form-control', 'data-requerido': '1'}) | raw }}
										</div>

									</div>
									
									<div class="col-md-4">
										<div class="form-group">
											{{  form.field(modelo, 'clave').passwordInput({'class': 'form-control', 'data-requerido': '1'}) | raw }}
										</div>	
									</div>
									
									<div class="col-md-4">
										<div class="form-group">
											<div class="form-group field-medicos-clave-confirmar required">
												<label class="control-label" for="medicos-clave-confirmar">Confirmar Clave</label>
												<input type="password" id="medicos-clave-confirmar" class="form-control" data-requerido="1" aria-required="true">

												<p class="help-block help-block-error"></p>
											</div>
										</div>	
									</div>
								</div>
								
							
							</div>
						</div>
							
						
						
						<div class="text-right">
							{% if editar == False %}
								<a href="/admin/web/medicos"><button type="button" class="btn btn-info">Regresar</button></a>
								<button type="submit" class="btn btn-info">Agregar</button>
							{% else %}
								<a href="/admin/web/medicos"><button type="button" class="btn btn-info">Regresar</button></a>
								<button type="submit" class="btn btn-info">Guardar Cambios</button>
							{% endif %}
						</div>
						
					{{ active_form_end() }}

				</div>
			</div>
		</div>
		
		
    </div>
    <!-- /.container-fluid -->
{% endblock contenido %}

{% block extra_js %}
	<script>
		$(function(){
			// PARA ABRIR LAS OPCIONES DEL MENU
			$('#menu-web').addClass('selected');

			$('#medicos-codigo').val('1');
			$('#medicos-especialidad').val('Medicina General');
			
			{% if editar == true %}
				$('#medicos-clave').val('');
				$('#medicos-clave').data('requerido', '0');
				$('#medicos-clave-confirmar').data('requerido', '0');
			{% endif %}
		});		
		
		$('#form_agregar_modelo').submit(function(){
			var error_campos = false;			
			$('.form-control').each(function(campo){
				if($(this).val() == '' && $(this).data('requerido') == 1){
					$(this).parent().parent().addClass('has-error');						
					error_campos = true;
				}
				else
					$(this).parent().parent().removeClass('has-error');
			});	
			
			if(!error_campos && $('#medicos-clave').val() != $('#medicos-clave-confirmar').val()){
				$('#medicos-clave').parent().addClass('has-error');
				$('#medicos-clave-confirmar').parent().addClass('has-error');
				
				alert('Las dos contraseñas deben coincidir. Intente nuevamente...');
				error_campos = true;
			}
						
			if(error_campos){
				$('#notificacion_campos').css('display', '');
				return false;
			}
		});
	</script>
{% endblock extra_js %}